# Loading helper functions
source "$FRESH_LOCAL"/lib/functions.sh

# Handles updating fresh
fresh freshshell/fresh bin/fresh --bin

# Bash setup
if _running_bash; then
  # OS X Terminal App sources ~/.bash_profile instead of ~/.bashrc
  if _running_osx; then
    bash_init_file="~/.bash_profile"
  else
    bash_init_file="~/.bashrc"
  fi
  fresh freshshell/fresh contrib/source-build.sh --file="$bash_init_file"
  # Enabling fresh's Bash completions
  fresh freshshell/fresh contrib/completion/fresh-completion.bash
  fresh bash/aliases/\*
  fresh bash/config/\*
fi

# Git setup
if _installed git; then
  _include "git/setup.sh"
  local __git_config="~/.gitconfig.local"
  GIT_CONFIG=$(eval echo $__git_config) _git_setup

  fresh git/gitconfig --file --filter="sed 's+_GIT_CONFIG_+${__git_config}+g'"
  fresh git/gitignore.global --file
fi

# rbenv setup
if _installed rbenv; then
  if _installed brew; then
    fresh rbenv/homebrew.sh
  fi
  fresh rbenv/init.sh
fi

# Ruby
if _installed ruby; then
  fresh ruby/irbrc --file
fi

# OS X setup
if _running_osx; then
  _include "osx/defaults/*.sh"
  if _directory_exists /Developer/NVIDIA/CUDA-7.0; then
    fresh osx/cuda/\*
  fi
fi

# Heroku setup
if _directory_exists /usr/local/heroku/bin; then
  fresh heroku/\*
fi
